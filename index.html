<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>3D é¡¯ç¤º C A R å­—æ¯</title>
  <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar.min.js"></script>
  <style>
    body, html {
      margin: 0;
      overflow: hidden;
    }
    #speech-display {
      position: fixed;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0,0,0,0.7);
      color: #fff;
      padding: 10px 20px;
      border-radius: 10px;
      font-family: sans-serif;
      font-size: 1.2em;
      z-index: 999;
    }
  </style>
</head>
<body>
  <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false;">

    <!-- Marker C -->
    <a-marker id="markerC" type="pattern" url="pattern-C.patt">
      <a-entity id="modelC" gltf-model="A2.glb" position="0 0.1 0" scale="0.8 0.8 0.8"
        look-at="[camera]"
        animation="property: position; dir: alternate; dur: 1000; easing: easeInOutSine; loop: true; to: 0 0.3 0">
      </a-entity>
    </a-marker>

    <!-- Marker A -->
    <a-marker id="markerA" type="pattern" url="pattern-A.patt">
      <a-entity id="modelA" gltf-model="A2.glb" position="0 0.1 0" scale="0.8 0.8 0.8"
        look-at="[camera]"
        animation="property: position; dir: alternate; dur: 1000; easing: easeInOutSine; loop: true; to: 0 0.3 0">
      </a-entity>

      <!-- æ”¾å¤§ A æ¨¡å‹ï¼ˆåˆå§‹éš±è—ï¼Œå¯é»æ“Šï¼‰ -->
      <a-entity id="bigA" gltf-model="A2.glb" position="0 0.4 0" scale="1.5 1.5 1.5"
        visible="false"
        class="clickable"
        animation__float="property: position; dir: alternate; dur: 1000; easing: easeInOutSine; loop: true; to: 0 0.6 0">
      </a-entity>
    </a-marker>

    <!-- Marker R -->
    <a-marker id="markerR" type="pattern" url="pattern-R.patt">
      <a-entity id="modelR" gltf-model="A2.glb" position="0 0.1 0" scale="0.8 0.8 0.8"
        look-at="[camera]"
        animation="property: position; dir: alternate; dur: 1000; easing: easeInOutSine; loop: true; to: 0 0.3 0">
      </a-entity>
    </a-marker>

    <!-- ç›¸æ©Ÿèˆ‡æ»‘é¼ å…‰æ¨™ï¼ˆæ”¯æ´é»æ“Šï¼‰ -->
    <a-entity camera>
      <a-entity cursor="rayOrigin: mouse" raycaster="objects: .clickable"></a-entity>
    </a-entity>
  </a-scene>

  <!-- èªéŸ³è¾¨è­˜é¡¯ç¤º -->
  <div id="speech-display">
    ğŸ™ï¸ èªéŸ³è¼¸å…¥ï¼š<span id="speech-text">ï¼ˆç­‰å¾…ä¸­...ï¼‰</span>
  </div>

  <script>
    let isCVisible = false;
    let isAVisible = false;
    let isRVisible = false;
    let isRotating = false;

    const markerC = document.querySelector('#markerC');
    const markerA = document.querySelector('#markerA');
    const markerR = document.querySelector('#markerR');
    const bigA = document.querySelector('#bigA');
    const speechText = document.getElementById('speech-text');

    markerC.addEventListener('markerFound', () => { isCVisible = true; updateBigA(); });
    markerC.addEventListener('markerLost', () => { isCVisible = false; updateBigA(); });

    markerA.addEventListener('markerFound', () => { isAVisible = true; updateBigA(); });
    markerA.addEventListener('markerLost', () => { isAVisible = false; updateBigA(); });

    markerR.addEventListener('markerFound', () => { isRVisible = true; updateBigA(); });
    markerR.addEventListener('markerLost', () => { isRVisible = false; updateBigA(); });

    function updateBigA() {
      const showBigA = isCVisible && isAVisible && isRVisible;
      bigA.setAttribute('visible', showBigA);

      document.querySelector('#modelA').setAttribute('visible', !showBigA);
      document.querySelector('#modelC').setAttribute('visible', !showBigA);
      document.querySelector('#modelR').setAttribute('visible', !showBigA);
    }

    // é»æ“Š bigA è§¸ç™¼æ—‹è½‰å‹•ç•«
    bigA.addEventListener('click', () => {
      if (!isRotating) {
        bigA.setAttribute('animation__rotate', {
          property: 'rotation',
          to: '0 360 0',
          loop: true,
          dur: 2000,
          easing: 'linear'
        });
        isRotating = true;
      } else {
        bigA.removeAttribute('animation__rotate');
        isRotating = false;
      }
    });

    // èªéŸ³è¾¨è­˜æ§åˆ¶æ—‹è½‰æ–¹å‘
    if ('webkitSpeechRecognition' in window) {
      const recognition = new webkitSpeechRecognition();
      recognition.lang = 'zh-TW';
      recognition.continuous = true;
      recognition.interimResults = true;

      recognition.onresult = (event) => {
        let interim = '';
        for (let i = event.resultIndex; i < event.results.length; ++i) {
          const result = event.results[i];
          if (result.isFinal) {
            const command = result[0].transcript.trim();
            speechText.textContent = command;

            if (command.includes("å·¦è½‰")) {
              bigA.setAttribute('rotation', '0 -90 0');
            } else if (command.includes("å³è½‰")) {
              bigA.setAttribute('rotation', '0 90 0');
            }
          } else {
            interim += result[0].transcript;
            speechText.textContent = interim + '...';
          }
        }
      };

      recognition.onerror = () => {
        speechText.textContent = 'âš ï¸ èªéŸ³è¾¨è­˜éŒ¯èª¤ï¼Œé‡æ–°å•Ÿå‹•ä¸­...';
        recognition.stop();
      };

      recognition.onend = () => {
        setTimeout(() => recognition.start(), 1000);
      };

      recognition.start();
    } else {
      speechText.textContent = 'âŒ ä¸æ”¯æ´èªéŸ³è¾¨è­˜ï¼Œè«‹ä½¿ç”¨ Chrome ç€è¦½å™¨';
    }
  </script>
</body>
</html>


























